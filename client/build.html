<!doctype html>
<html lang="en">

<head>
  <title>Title</title>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS v5.0.2 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

</head>

<body>
  <div class="container mt-4">
    <p id="disclaimer" style="border: dotted black 2px; padding: 10px"><b>DISCLAIMER - PLEASE READ </b><br>
      Your deno project can be publicly removed by the server admin for any reason, such as:<br>
      - Your project is not compatible with the latest version of the server<br>
      - Your project contains malicious code (without permission)<br>
      - Your project contains violent or adult content<br>
      - Your project contains copyrighted content<br>
      - Your project attempts compromise its users' privacy<br>
      Do not use this app to engage in illegal activities.<br>
      <button onclick="acceptDisclaimer()">Ok, I agree</button>
    </p>
    <h2>Build deno project</h2>
    <div class="row">
      <p>Jumpstart your progress by starting from a template. Full explanation and code docs are given in the
        <b>default</b> template.</p>
      <div class="col-md-12">
        <div class="dropdown">
          <button class="btn btn-secondary dropdown-toggle" type="button" id="triggerId" data-bs-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">
            Choose template
          </button>
          <button id="build-refresh" class="btn btn-success" onclick="refreshTemplateOptions()">Refresh</button>
          <div class="dropdown-menu" aria-labelledby="triggerId" style="height: 300px; overflow-y: scroll;">
            <h6 class="dropdown-header">Start here</h6>
            <a class="dropdown-item" href="#">default</a>
            <div class="dropdown-divider"></div>


            <h6 class="dropdown-header">Basic</h6>
            <div id="template-basic">
              <a class="dropdown-item" href="#">live-chat</a>
              <a class="dropdown-item" href="#">shared-canvas</a>
              <a class="dropdown-item" href="#">input-output</a>
            </div>

            <div class="dropdown-divider"></div>
            <h6 class="dropdown-header">Community</h6>
            <div id="template-community">
              <a class="dropdown-item" href="#">Action</a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <h5 class="mt-3">Template:<span id="build-title"></span></h5>
    <form class="row">
      <div class="form-group col-8">
        <label for="build-new-name">New name</label>
        <input type="text" class="form-control" id="build-new-name" placeholder="Project name">
      </div>
      <div class="form-group col-4">
        <label for="build-version">Version</label>
        <input type="text" class="form-control" id="build-version" placeholder="1.0">
      </div>
    </form>
    <div class="form-group">
      <label for="build-desc">Description</label>
      <!-- Multi-line -->
      <textarea class="form-control" id="build-desc" rows="3"></textarea>
      <input class="form-check-input" type="checkbox" value="" id="build-is-template">
      <label class="form-check-label" for="defaultCheck1">
        List as template
      </label>
    </div>
    <br>
    <div class="mb-3">
    <button id="build-back" class="btn btn-dark" onclick="chPage('home')">Back</button>
    <button id="build-create" class="btn btn-primary" disabled onclick="buildProjectFromTemplate()">Create</button>
    <a href="javascript:void(0)" style="float:right" onclick="viewDisclaimer()">View disclaimer</a>
  </div>
    


  </div>
  <!-- Bootstrap JavaScript Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
    integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
    crossorigin="anonymous"></script>
</body>






<script>
  // SCRIPT.BUILD
  // Detect dropdown selection without jQuery
  var dropdown = document.querySelector('.dropdown-menu');
  document.querySelector('.dropdown-toggle').addEventListener('click', function () {
    dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
  });
  document.querySelectorAll('.dropdown-menu a').forEach(function (element) {
    element.addEventListener('click', function () {
      dropdown.style.display = 'none';
      let name = element.textContent;
      onTemplateSelect(name);
    });
  });
  function onTemplateSelect(projName) {
    console.log(projName);
    document.querySelector('#build-title').innerHTML = projName;
    document.querySelector('#build-version').value = "1.0"
    document.querySelector('#build-desc').value = 'Description';
  }
  function acceptDisclaimer() {
    document.querySelector('#disclaimer').style.display = 'none';
    document.querySelector('#build-create').disabled = false;
  }
  function viewDisclaimer() {
    document.querySelector('#disclaimer').style.display = 'block';
  }
  function populateTemplateOptions(projects) {
    let templateBasic = document.querySelector('#template-basic');
    let templateCommunity = document.querySelector('#template-community');
    projNames.filter(proj => proj.isTemplate).forEach(function (proj) {
      let option = document.createElement('a');
      option.className = 'dropdown-item';
      option.href = '#';
      option.textContent = proj.name;
      let templateOptions = proj.isBasicTemplate ? templateBasic : templateCommunity;
      templateOptions.appendChild(option);
    });
  }
  function refreshTemplateOptions() {
    document.querySelector('#build-refresh').disabled = true;
    let templateBasic = document.querySelector('#template-basic');
    let templateCommunity = document.querySelector('#template-community');
    templateBasic.innerHTML = '';
    templateCommunity.innerHTML = '';
    send("!deno-get-projects")
    ///////////populateTemplateOptions(projNames);
  }
  function buildProjectFromTemplate() {
    let projBasedOn = document.querySelector('#build-title').innerHTML;
    let projName = document.querySelector('#build-new-name').value;
    let projVersion = document.querySelector('#build-version').value;
    let projDesc = document.querySelector('#build-desc').value;
    let projIsTemplate = document.querySelector('#build-is-template').checked;
    if (projName == '') {
      alert('Project name cannot be empty');
      return;
    }
    if (projects.find(proj => proj.name == projName)) {
      alert('Project name already exists');
      return;
    }
    if (projBasedOn == '') {
      alert('Please select a template');
      return;
    }
    let projObj = {
      basedOn: projBasedOn,
      name: projName,
      desc: projDesc,
      version: projVersion,
      isTemplate: projIsTemplate,
    };
    console.log('!deno-create-project ' + JSON.stringify(projObj));
  }





</script>




















</html>